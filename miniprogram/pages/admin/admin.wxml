<view class="container">
  <view class="card">
    <view class="title">{{i18n.admin_create_season}}</view>
    <view class="label">{{i18n.admin_season_name}}</view>
    <input class="input" data-field="name" bindinput="onNewSeasonInput" placeholder="2026 Spring" />
    <view class="label">{{i18n.admin_start_date}}</view>
    <input class="input" data-field="startDate" bindinput="onNewSeasonInput" placeholder="2026-02-01" />
    <view class="label">{{i18n.admin_end_date}}</view>
    <input class="input" data-field="endDate" bindinput="onNewSeasonInput" placeholder="2026-05-31" />
    <view class="button" bindtap="createSeason">{{i18n.admin_create_season || 'Create Season'}}</view>
  </view>

  <view class="section-title">{{i18n.admin_seasons}}</view>
  <block wx:for="{{seasons}}" wx:key="_id">
    <view class="card season-card" data-id="{{item._id}}" bindtap="viewSeasonResults">
      <view class="title">{{item.name}}</view>
      <view class="status-row">
        <view class="status-badge {{item.status}}">{{item.status === 'active' ? i18n.admin_season_status_active : (item.status === 'closed' ? i18n.admin_season_status_closed : i18n.admin_season_status_inactive)}}</view>
        <view class="status-badge current" wx:if="{{item._id === activeSeasonId}}">{{i18n.admin_season_current}}</view>
      </view>
      <view class="label hint">{{i18n.admin_tap_to_view}}</view>
      <view class="button" data-id="{{item._id}}" catchtap="setActiveSeason" wx:if="{{item._id === activeSeasonId}}">
        {{i18n.admin_deactivate || 'Deactivate'}}
      </view>
      <view class="button secondary" data-id="{{item._id}}" catchtap="setActiveSeason" wx:else>
        {{i18n.admin_set_active || 'Set Active'}}
      </view>
    </view>
  </block>

  <view class="card">
    <view class="title">{{i18n.admin_adjust_points}}</view>
    <view class="label">{{i18n.admin_seasons}}</view>
    <picker mode="selector" range="{{seasons}}" range-key="name" bindchange="onAdjustSeasonPicker">
      <view class="input picker-value">{{seasonAdjustInput.seasonName || i18n.common_select}}</view>
    </picker>
    <view class="label">{{i18n.admin_players}}</view>
    <picker mode="selector" range="{{players}}" range-key="name" bindchange="onAdjustPlayerPicker">
      <view class="input picker-value">{{seasonAdjustInput.playerName || i18n.common_select}}</view>
    </picker>
    <view class="label">{{i18n.admin_delta_points}}</view>
    <input class="input" type="number" data-field="deltaPoints" bindinput="onSeasonAdjustInput" placeholder="5 / -3" />
    <view class="label">{{i18n.admin_reason}}</view>
    <input class="input" data-field="reason" bindinput="onSeasonAdjustInput" />
    <view class="button" bindtap="adjustSeasonPoints">{{i18n.admin_apply_adjustment || 'Apply Adjustment'}}</view>
  </view>

  <view class="card">
    <view class="title">{{i18n.admin_create_event}}</view>
    <view class="label">{{i18n.admin_event_title}}</view>
    <input class="input" data-field="title" bindinput="onNewEventInput" />
    <view class="label">{{i18n.event_date}}</view>
    <picker mode="date" value="{{newEvent.date}}" bindchange="onEventDateChange">
      <view class="input picker-value">{{newEvent.date || i18n.common_select}}</view>
    </picker>
    <view class="label">{{i18n.event_location}}</view>
    <input class="input" data-field="location" bindinput="onNewEventInput" />
    <view class="label">{{i18n.admin_start_time}}</view>
    <picker mode="time" value="{{newEvent.startTime}}" bindchange="onEventStartTimeChange">
      <view class="input picker-value">{{newEvent.startTime || i18n.common_select}}</view>
    </picker>
    <view class="label">{{i18n.admin_end_time}}</view>
    <picker mode="time" value="{{newEvent.endTime}}" bindchange="onEventEndTimeChange">
      <view class="input picker-value">{{newEvent.endTime || i18n.common_select}}</view>
    </picker>
    <view class="button" bindtap="createEvent">{{i18n.admin_create_event || 'Create Event'}}</view>
  </view>

  <view class="section-title">{{i18n.admin_manage_events}}</view>
  <block wx:for="{{events}}" wx:key="_id">
    <view class="card event-card {{item.status === 'completed' ? 'completed' : ''}}" data-id="{{item._id}}" bindtap="goToEvent">
      <view class="event-header">
        <view class="title clickable">{{item.title}}</view>
        <view class="status-badge {{item.status}}">{{item.status}}</view>
      </view>
      <view class="label">{{item.date}} - {{item.location}}</view>
      <view class="label hint">{{i18n.admin_tap_to_manage || 'Tap to manage'}}</view>
    </view>
  </block>

  <view class="card">
    <view class="title">{{i18n.admin_test_players || 'Test Players'}}</view>
    <view class="label">{{i18n.admin_test_players_desc || 'Manage test players for matchup testing'}}</view>

    <view class="label">{{i18n.profile_name}}</view>
    <input class="input" data-field="name" bindinput="onTestPlayerInput" value="{{testPlayerInput.name}}" />
    <view class="label">{{i18n.profile_gender}}</view>
    <picker mode="selector" range="{{genderLabels}}" value="{{testPlayerInput.genderIndex}}" bindchange="onTestPlayerGenderChange">
      <view class="input picker-value">{{genderLabels[testPlayerInput.genderIndex] || i18n.common_select}}</view>
    </picker>
    <view class="label">{{i18n.profile_ntrp}}</view>
    <picker mode="selector" range="{{ntrpOptions}}" value="{{testPlayerInput.ntrpIndex}}" bindchange="onTestPlayerNtrpChange">
      <view class="input picker-value">{{testPlayerInput.ntrp || i18n.common_select}}</view>
    </picker>
    <view class="button" bindtap="addTestPlayer">{{i18n.admin_add_test_player || 'Add Test Player'}}</view>

    <view class="label" style="margin-top: 20px;">{{i18n.admin_remove_test_player || 'Remove Test Player'}}</view>
    <picker mode="selector" range="{{testPlayers}}" range-key="name" bindchange="onDeleteTestPlayerPicker">
      <view class="input picker-value">{{deleteTestPlayerInput.playerName || i18n.common_select}}</view>
    </picker>
    <view class="button secondary" bindtap="deleteTestPlayer">{{i18n.admin_delete_player}}</view>
  </view>

  <view class="card">
    <view class="title">{{i18n.admin_signup_players || 'Sign Up Players'}}</view>
    <view class="label">{{i18n.admin_signup_players_desc || 'Sign up players for events'}}</view>

    <view class="label">{{i18n.admin_select_event}}</view>
    <picker mode="selector" range="{{events}}" range-key="displayName" bindchange="onSignupEventPicker">
      <view class="input picker-value">{{playerSignup.eventDisplayName || i18n.common_select}}</view>
    </picker>

    <view class="label">{{i18n.admin_select_player}}</view>
    <picker mode="selector" range="{{playerSignup.availablePlayers}}" range-key="displayName" bindchange="onSignupPlayerPicker" disabled="{{!playerSignup.eventId}}" catchtap="refreshSignupPlayers">
      <view class="input picker-value {{!playerSignup.eventId ? 'disabled' : ''}}">{{playerSignup.playerName || (playerSignup.eventId ? i18n.admin_select_player : i18n.admin_select_event_first)}}</view>
    </picker>

    <view class="button" bindtap="signupPlayer">{{i18n.admin_signup_player || 'Sign Up Player'}}</view>
  </view>

</view>
