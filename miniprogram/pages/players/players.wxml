<view class="container">
  <view class="section-title">{{i18n.players_title}}</view>

  <view class="filter-bar">
    <view class="filter-group">
      <text class="filter-label">{{i18n.players_filter_gender}}</text>
      <radio-group bindchange="onGenderFilterChange" class="filter-options">
        <label class="filter-option">
          <radio value="all" checked="{{genderFilter === 'all'}}" />{{i18n.common_all}}
        </label>
        <label class="filter-option">
          <radio value="M" checked="{{genderFilter === 'M'}}" />{{i18n.gender_male}}
        </label>
        <label class="filter-option">
          <radio value="F" checked="{{genderFilter === 'F'}}" />{{i18n.gender_female}}
        </label>
      </radio-group>
    </view>

    <view class="filter-group">
      <text class="filter-label">{{i18n.players_sort_by}}</text>
      <radio-group bindchange="onSortChange" class="filter-options">
        <label class="filter-option">
          <radio value="ntrp" checked="{{sortBy === 'ntrp'}}" />NTRP
        </label>
        <label class="filter-option">
          <radio value="name" checked="{{sortBy === 'name'}}" />{{i18n.players_sort_name}}
        </label>
      </radio-group>
    </view>
  </view>

  <block wx:if="{{players.length === 0 && !loading}}">
    <view class="card">
      <view class="empty-message">{{i18n.players_no_players}}</view>
    </view>
  </block>

  <block wx:for="{{players}}" wx:key="_id">
    <view class="card player-card" data-id="{{item._id}}" bindtap="openPlayerModal">
      <view class="player-info">
        <view class="player-name">{{item.name || i18n.common_unnamed}}</view>
        <view class="player-details">
          <text class="badge ntrp">NTRP {{item.ntrp || 'N/A'}}</text>
          <text class="badge gender">{{item.gender === 'F' ? i18n.gender_female : i18n.gender_male}}</text>
          <text class="badge test" wx:if="{{item.isTestPlayer}}">{{i18n.players_test_player || 'Test'}}</text>
          <text class="badge points" wx:if="{{item.points > 0}}">{{item.points}} {{i18n.season_points || 'pts'}}</text>
        </view>
      </view>
      <view class="arrow">›</view>
    </view>
  </block>

  <!-- Player Detail Modal -->
  <view class="modal-overlay" wx:if="{{modal.visible}}" bindtap="closePlayerModal">
    <view class="modal-content" catchtap="">
      <view class="modal-header">
        <text class="modal-title">{{modal.player.name}}</text>
        <text class="badge test modal-test-badge" wx:if="{{modal.player.isTestPlayer}}">{{i18n.players_test_player || 'Test'}}</text>
        <text class="modal-close" bindtap="closePlayerModal">×</text>
      </view>
      <view class="modal-body">
        <view class="detail-row">
          <text class="detail-label">{{i18n.profile_gender}}</text>
          <text class="detail-value">{{modal.player.gender === 'F' ? i18n.gender_female : i18n.gender_male}}</text>
        </view>
        <view class="detail-row">
          <text class="detail-label">{{i18n.profile_ntrp}}</text>
          <text class="detail-value">{{modal.player.ntrp || 'N/A'}}</text>
        </view>
        <view class="detail-row" wx:if="{{modal.stats}}">
          <text class="detail-label">{{i18n.season_points || 'Season Points'}}</text>
          <text class="detail-value">{{modal.stats.points || 0}}</text>
        </view>
        <view class="detail-row" wx:if="{{modal.player.notes}}">
          <text class="detail-label">{{i18n.admin_notes || 'Notes'}}</text>
          <text class="detail-value">{{modal.player.notes}}</text>
        </view>

        <view class="button secondary delete-btn" bindtap="deletePlayer" wx:if="{{isAdmin}}">
          {{i18n.admin_delete_player || 'Delete Player'}}
        </view>
      </view>
    </view>
  </view>
</view>
